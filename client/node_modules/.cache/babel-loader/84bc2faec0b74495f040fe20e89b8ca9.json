{"ast":null,"code":"var _jsxFileName = \"E:\\\\Book-lover-Git\\\\Book-lovers.com\\\\client\\\\src\\\\components\\\\sign-up\\\\login-form.js\";\nimport { useMutation, useQuery } from \"@apollo/client\";\nimport React, { useState, useEffect, useContext } from \"react\";\nimport { LOGIN_USER, GET_USER } from \"../../gql-helper/queries\";\nimport \"./login-form.css\";\nimport cookie from \"js-cookie\";\nimport { FilterContext } from \"../../context-helper/context-helper\";\nexport default function Login(props) {\n  const {\n    closeModal,\n    redirectSignUpModal\n  } = props,\n        [email, setEmail] = useState(\"\"),\n        [password, setPassword] = useState(\"\"),\n        [emailReq, setEmailReq] = useState(false),\n        [passwordReq, setPasswordReq] = useState(false),\n        [emailPasswordMismatched, setEmailPasswordMismatched] = useState(false);\n  const [loginUser, {\n    data\n  }] = useMutation(LOGIN_USER);\n  const {\n    addReviewBtn,\n    showAddReview\n  } = useContext(FilterContext);\n  const {\n    addReviewBtnClicked\n  } = addReviewBtn || {};\n  const {\n    setShowAddReviewModal\n  } = showAddReview || {};\n\n  const isFormValidated = () => {\n    if (!email) {\n      setEmailReq(true);\n      return false;\n    }\n\n    if (!password) {\n      setPasswordReq(true);\n      return false;\n    }\n\n    return true;\n  };\n\n  const validateAndLogin = async () => {\n    if (isFormValidated()) {\n      await loginUser({\n        variables: {\n          email: email,\n          password: password\n        }\n      });\n    }\n  };\n\n  const closeParentModal = () => closeModal ? closeModal() : false;\n\n  const redirectModal = () => {\n    closeParentModal();\n    if (redirectSignUpModal) redirectSignUpModal(true, \"signUp\");\n  };\n\n  useEffect(() => {\n    if (data && data.loginUser) {\n      let isValidAuth = data.loginUser._id ? true : false;\n\n      if (isValidAuth) {\n        if (data.loginUser.token) {\n          cookie.set(\"token\", data.loginUser.token, {\n            expires: 20\n          });\n          if (addReviewBtnClicked) setShowAddReviewModal(true);\n        }\n\n        closeParentModal();\n      } else setEmailPasswordMismatched(true);\n    }\n  }, [data]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    id: \"login-box\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }\n  }, emailPasswordMismatched ? /*#__PURE__*/React.createElement(\"span\", {\n    className: \"mismatch-error-class\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 11\n    }\n  }, \"*Email or Password mismatched\") : null, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"email\",\n    name: \"email\",\n    placeholder: \"E-mail\",\n    className: \"signupInput\",\n    onChange: e => {\n      setEmailReq(false);\n      setEmail(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 9\n    }\n  }), emailReq ? /*#__PURE__*/React.createElement(\"span\", {\n    className: \"error-class\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 11\n    }\n  }, \"*Email required.\") : null, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"password\",\n    name: \"password\",\n    placeholder: \"Password\",\n    className: \"signupInput\",\n    onChange: e => {\n      setPasswordReq(false);\n      setPassword(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 9\n    }\n  }), passwordReq ? /*#__PURE__*/React.createElement(\"span\", {\n    className: \"error-class\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 11\n    }\n  }, \"*Password required.\") : null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"redirect-to-log-in\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"first-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 11\n    }\n  }, \"Dont have an account? \"), \" \", /*#__PURE__*/React.createElement(\"span\", {\n    className: \"second-text\",\n    onClick: e => redirectModal(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 11\n    }\n  }, \" \", \"Sign up\")), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"submit\",\n    name: \"signup_submit\",\n    value: \"Log in\",\n    onClick: e => validateAndLogin(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 9\n    }\n  })));\n}","map":{"version":3,"sources":["E:/Book-lover-Git/Book-lovers.com/client/src/components/sign-up/login-form.js"],"names":["useMutation","useQuery","React","useState","useEffect","useContext","LOGIN_USER","GET_USER","cookie","FilterContext","Login","props","closeModal","redirectSignUpModal","email","setEmail","password","setPassword","emailReq","setEmailReq","passwordReq","setPasswordReq","emailPasswordMismatched","setEmailPasswordMismatched","loginUser","data","addReviewBtn","showAddReview","addReviewBtnClicked","setShowAddReviewModal","isFormValidated","validateAndLogin","variables","closeParentModal","redirectModal","isValidAuth","_id","token","set","expires","e","target","value"],"mappings":";AAAA,SAASA,WAAT,EAAsBC,QAAtB,QAAsC,gBAAtC;AACA,OAAOC,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,EAAqCC,UAArC,QAAuD,OAAvD;AACA,SAASC,UAAT,EAAqBC,QAArB,QAAqC,0BAArC;AACA,OAAO,kBAAP;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,SAASC,aAAT,QAA8B,qCAA9B;AAEA,eAAe,SAASC,KAAT,CAAeC,KAAf,EAAsB;AACnC,QAAM;AAAEC,IAAAA,UAAF;AAAcC,IAAAA;AAAd,MAAsCF,KAA5C;AAAA,QACE,CAACG,KAAD,EAAQC,QAAR,IAAoBZ,QAAQ,CAAC,EAAD,CAD9B;AAAA,QAEE,CAACa,QAAD,EAAWC,WAAX,IAA0Bd,QAAQ,CAAC,EAAD,CAFpC;AAAA,QAGE,CAACe,QAAD,EAAWC,WAAX,IAA0BhB,QAAQ,CAAC,KAAD,CAHpC;AAAA,QAIE,CAACiB,WAAD,EAAcC,cAAd,IAAgClB,QAAQ,CAAC,KAAD,CAJ1C;AAAA,QAKE,CAACmB,uBAAD,EAA0BC,0BAA1B,IAAwDpB,QAAQ,CAAC,KAAD,CALlE;AAOA,QAAM,CAACqB,SAAD,EAAY;AAAEC,IAAAA;AAAF,GAAZ,IAAwBzB,WAAW,CAACM,UAAD,CAAzC;AAEA,QAAM;AAAEoB,IAAAA,YAAF;AAAgBC,IAAAA;AAAhB,MAAkCtB,UAAU,CAACI,aAAD,CAAlD;AACA,QAAM;AAAEmB,IAAAA;AAAF,MAA0BF,YAAY,IAAI,EAAhD;AACA,QAAM;AAAEG,IAAAA;AAAF,MAA4BF,aAAa,IAAI,EAAnD;;AACA,QAAMG,eAAe,GAAG,MAAM;AAC5B,QAAI,CAAChB,KAAL,EAAY;AACVK,MAAAA,WAAW,CAAC,IAAD,CAAX;AACA,aAAO,KAAP;AACD;;AACD,QAAI,CAACH,QAAL,EAAe;AACbK,MAAAA,cAAc,CAAC,IAAD,CAAd;AACA,aAAO,KAAP;AACD;;AAED,WAAO,IAAP;AACD,GAXD;;AAaA,QAAMU,gBAAgB,GAAG,YAAY;AACnC,QAAID,eAAe,EAAnB,EAAuB;AACrB,YAAMN,SAAS,CAAC;AACdQ,QAAAA,SAAS,EAAE;AACTlB,UAAAA,KAAK,EAAEA,KADE;AAETE,UAAAA,QAAQ,EAAEA;AAFD;AADG,OAAD,CAAf;AAMD;AACF,GATD;;AAWA,QAAMiB,gBAAgB,GAAG,MAAOrB,UAAU,GAAGA,UAAU,EAAb,GAAkB,KAA5D;;AAEA,QAAMsB,aAAa,GAAG,MAAM;AAC1BD,IAAAA,gBAAgB;AAChB,QAAIpB,mBAAJ,EAAyBA,mBAAmB,CAAC,IAAD,EAAO,QAAP,CAAnB;AAC1B,GAHD;;AAKAT,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIqB,IAAI,IAAIA,IAAI,CAACD,SAAjB,EAA4B;AAC1B,UAAIW,WAAW,GAAGV,IAAI,CAACD,SAAL,CAAeY,GAAf,GAAqB,IAArB,GAA4B,KAA9C;;AAEA,UAAID,WAAJ,EAAiB;AACf,YAAIV,IAAI,CAACD,SAAL,CAAea,KAAnB,EAA0B;AACxB7B,UAAAA,MAAM,CAAC8B,GAAP,CAAW,OAAX,EAAoBb,IAAI,CAACD,SAAL,CAAea,KAAnC,EAA0C;AAAEE,YAAAA,OAAO,EAAE;AAAX,WAA1C;AAEA,cAAIX,mBAAJ,EAAyBC,qBAAqB,CAAC,IAAD,CAArB;AAC1B;;AAEDI,QAAAA,gBAAgB;AACjB,OARD,MAQOV,0BAA0B,CAAC,IAAD,CAA1B;AACR;AACF,GAdQ,EAcN,CAACE,IAAD,CAdM,CAAT;AAgBA,sBACE;AAAK,IAAA,EAAE,EAAC,WAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGH,uBAAuB,gBACtB;AAAM,IAAA,SAAS,EAAC,sBAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qCADsB,GAIpB,IALN,eAME;AACE,IAAA,IAAI,EAAC,OADP;AAEE,IAAA,IAAI,EAAC,OAFP;AAGE,IAAA,WAAW,EAAC,QAHd;AAIE,IAAA,SAAS,EAAC,aAJZ;AAKE,IAAA,QAAQ,EAAGkB,CAAD,IAAO;AACfrB,MAAAA,WAAW,CAAC,KAAD,CAAX;AACAJ,MAAAA,QAAQ,CAACyB,CAAC,CAACC,MAAF,CAASC,KAAV,CAAR;AACD,KARH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IANF,EAgBGxB,QAAQ,gBACP;AAAM,IAAA,SAAS,EAAC,aAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADO,GAEL,IAlBN,eAmBE;AACE,IAAA,IAAI,EAAC,UADP;AAEE,IAAA,IAAI,EAAC,UAFP;AAGE,IAAA,WAAW,EAAC,UAHd;AAIE,IAAA,SAAS,EAAC,aAJZ;AAKE,IAAA,QAAQ,EAAGsB,CAAD,IAAO;AACfnB,MAAAA,cAAc,CAAC,KAAD,CAAd;AACAJ,MAAAA,WAAW,CAACuB,CAAC,CAACC,MAAF,CAASC,KAAV,CAAX;AACD,KARH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAnBF,EA6BGtB,WAAW,gBACV;AAAM,IAAA,SAAS,EAAC,aAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BADU,GAER,IA/BN,eAiCE;AAAK,IAAA,SAAS,EAAC,oBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAM,IAAA,SAAS,EAAC,YAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8BADF,EAC6D,GAD7D,eAEE;AAAM,IAAA,SAAS,EAAC,aAAhB;AAA8B,IAAA,OAAO,EAAGoB,CAAD,IAAON,aAAa,EAA3D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG,GADH,YAFF,CAjCF,eAyCE;AACE,IAAA,IAAI,EAAC,QADP;AAEE,IAAA,IAAI,EAAC,eAFP;AAGE,IAAA,KAAK,EAAC,QAHR;AAIE,IAAA,OAAO,EAAGM,CAAD,IAAOT,gBAAgB,EAJlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAzCF,CADF,CADF;AAoDD","sourcesContent":["import { useMutation, useQuery } from \"@apollo/client\";\r\nimport React, { useState, useEffect, useContext } from \"react\";\r\nimport { LOGIN_USER, GET_USER } from \"../../gql-helper/queries\";\r\nimport \"./login-form.css\";\r\nimport cookie from \"js-cookie\";\r\nimport { FilterContext } from \"../../context-helper/context-helper\";\r\n\r\nexport default function Login(props) {\r\n  const { closeModal, redirectSignUpModal } = props,\r\n    [email, setEmail] = useState(\"\"),\r\n    [password, setPassword] = useState(\"\"),\r\n    [emailReq, setEmailReq] = useState(false),\r\n    [passwordReq, setPasswordReq] = useState(false),\r\n    [emailPasswordMismatched, setEmailPasswordMismatched] = useState(false);\r\n\r\n  const [loginUser, { data }] = useMutation(LOGIN_USER);\r\n\r\n  const { addReviewBtn, showAddReview } = useContext(FilterContext);\r\n  const { addReviewBtnClicked } = addReviewBtn || {};\r\n  const { setShowAddReviewModal } = showAddReview || {};\r\n  const isFormValidated = () => {\r\n    if (!email) {\r\n      setEmailReq(true);\r\n      return false;\r\n    }\r\n    if (!password) {\r\n      setPasswordReq(true);\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  };\r\n\r\n  const validateAndLogin = async () => {\r\n    if (isFormValidated()) {\r\n      await loginUser({\r\n        variables: {\r\n          email: email,\r\n          password: password,\r\n        },\r\n      });\r\n    }\r\n  };\r\n\r\n  const closeParentModal = () => (closeModal ? closeModal() : false);\r\n\r\n  const redirectModal = () => {\r\n    closeParentModal();\r\n    if (redirectSignUpModal) redirectSignUpModal(true, \"signUp\");\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (data && data.loginUser) {\r\n      let isValidAuth = data.loginUser._id ? true : false;\r\n\r\n      if (isValidAuth) {\r\n        if (data.loginUser.token) {\r\n          cookie.set(\"token\", data.loginUser.token, { expires: 20 });\r\n\r\n          if (addReviewBtnClicked) setShowAddReviewModal(true);\r\n        }\r\n\r\n        closeParentModal();\r\n      } else setEmailPasswordMismatched(true);\r\n    }\r\n  }, [data]);\r\n\r\n  return (\r\n    <div id=\"login-box\">\r\n      <div className=\"left\">\r\n        {emailPasswordMismatched ? (\r\n          <span className=\"mismatch-error-class\">\r\n            *Email or Password mismatched\r\n          </span>\r\n        ) : null}\r\n        <input\r\n          type=\"email\"\r\n          name=\"email\"\r\n          placeholder=\"E-mail\"\r\n          className=\"signupInput\"\r\n          onChange={(e) => {\r\n            setEmailReq(false);\r\n            setEmail(e.target.value);\r\n          }}\r\n        />\r\n        {emailReq ? (\r\n          <span className=\"error-class\">*Email required.</span>\r\n        ) : null}\r\n        <input\r\n          type=\"password\"\r\n          name=\"password\"\r\n          placeholder=\"Password\"\r\n          className=\"signupInput\"\r\n          onChange={(e) => {\r\n            setPasswordReq(false);\r\n            setPassword(e.target.value);\r\n          }}\r\n        />\r\n        {passwordReq ? (\r\n          <span className=\"error-class\">*Password required.</span>\r\n        ) : null}\r\n\r\n        <div className=\"redirect-to-log-in\">\r\n          <span className=\"first-text\">Dont have an account? </span>{\" \"}\r\n          <span className=\"second-text\" onClick={(e) => redirectModal()}>\r\n            {\" \"}\r\n            Sign up\r\n          </span>\r\n        </div>\r\n\r\n        <input\r\n          type=\"submit\"\r\n          name=\"signup_submit\"\r\n          value=\"Log in\"\r\n          onClick={(e) => validateAndLogin()}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}